<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta http-equiv="X-UA-Compatible" content="ie=edge">
  <title>United States License Plate Game</title>
  <link rel="manifest" href="/manifest.json">

  <meta name="theme-color" content="#2196f3"/>

  <link href="styles.css" rel="stylesheet" type="text/css" />
  <style>
    .selections {
      margin-top: 4rem;
    }
    .selections .tip {
      color: gray;
      font-family: Arial;
      margin-top: 0.25rem;      
    }

    .trips {
      background-color: lightsteelblue;
      bottom: 0;
      box-sizing: border-box;
      height: calc(100vh - 13rem);
      left: 0;
      overflow-x: hidden;
      overflow-y: auto;
      padding: 1rem;
      position: fixed;
      width: 100vw;
    }

    .trip {
      margin-bottom: 0.5rem;
    }
    .trip .display {
      background-color: blue;
      border: 1px solid gray;
      color: white;
      display: inline-block;
      font-weight: bold;
      padding: 0.5rem;
      width: 70%;
    }
    .display .name {
      overflow: hidden;
      text-overflow: ellipsis;      
      white-space: nowrap;
      width: 100%;
    }
    .trip .navigation {
      display: inline-block;
      height: 2.5rem;
      text-align: right;
      width: calc(100% - calc(70% + 1.5rem));
    }
    .navigation svg {
      height: 1.5rem;
      width: 1.5rem;
    }
  </style>
</head>
<body>
  <header>
    <div>United States</div><div>License Plate Game</div>
  </header>

  <div class="selections">
    <div class="half">
      <a class="btn hidden" href="new-trip.html">
        <svg
          version="1.1" id="Capa_1" xmlns="http://www.w3.org/2000/svg"
          xmlns:xlink="http://www.w3.org/1999/xlink"
            x="0px" y="0px" width="93.934px" height="93.934px" viewBox="0 0 93.934 93.934"
            xml:space="preserve">
        <g>
          <path fill="#00aa00" d="M46.967,0C21.028,0,0,21.028,0,46.967c0,25.939,21.028,46.967,46.967,46.967c25.939,0,46.967-21.027,46.967-46.967
            C93.934,21.028,72.906,0,46.967,0z M74.812,53.924H53.924v20.889H40.01V53.924H19.121V40.01H40.01V19.121h13.914V40.01h20.889
            V53.924z"/>
        </g>
        </svg>          
        <div class="tip">New Trip</div>
      </a>
    </div>
    <div class="half">
        <a class="btn hidden" href="ideas.html">
          <svg
            version="1.1" id="Capa_1"
            xmlns="http://www.w3.org/2000/svg"
            xmlns:xlink="http://www.w3.org/1999/xlink"
            x="0px" y="0px" viewBox="0 0 340 340"
            xml:space="preserve">
          <path fill="#00aa00" d="M170,0C76.109,0,0,76.112,0,170s76.109,170,170,170c93.89,0,170-76.112,170-170S263.89,0,170,0z M169.633,281.611
            c-12.574,0-22.803-10.23-22.803-22.804c0-12.573,10.229-22.803,22.803-22.803c12.575,0,22.806,10.229,22.806,22.803
            C192.439,271.381,182.208,281.611,169.633,281.611z M205.357,169.659c-9.856,9.221-16.367,15.312-16.367,30.062v10.911
            c0,2.761-2.238,5-5,5h-27.122c-2.762,0-5-2.239-5-5v-10.911c0-30.293,15.744-45.076,27.239-55.87
            c9.785-9.179,16.248-15.242,16.248-29.778c0-4.591,0-18.562-24.925-18.562c-23.37,0-24.306,12.883-24.705,18.384l-0.813,11.186
            c-0.099,1.346-0.736,2.596-1.771,3.464c-1.031,0.87-2.372,1.282-3.715,1.148l-27.051-2.707c-2.7-0.27-4.691-2.645-4.488-5.351
            l0.799-10.613c2.41-31.974,26.749-52.634,62.006-52.634c18.438,0,33.952,5.176,44.865,14.968
            c11.066,9.931,16.918,24.102,16.918,40.98C232.477,144.265,216.802,158.942,205.357,169.659z"/>
          </svg>            
          <div class="tip">Game Ideas</div>
        </a>      
      </div>
  </div>

  <div id="trips" class="trips"></div>

  <script src="storage.js"></script>
  <script>
    const storage = new Storage();

    buildTrips();

    function buildTrips() {
      const trips = storage.getAllTrips();
      const tripsElement = document.getElementById('trips');

      let html = '';
      for (let trip of trips) {
        html += `<div class="trip">\n`;
        html += `  <div class="display" onclick="startTrip('${trip.name}')">\n`;
        html += `    <div class="name">${trip.name}</div>\n`;

        let countText = '';
        if (trip.found === 0) {
          countText = '(NOT STARTED)';
        } else if (trip.found === 1) {
          countText = '1 STATE FOUND';
        } else {
          countText = trip.found + ' STATES FOUND';
        }
        html += `    <div class="found">${countText}</div>\n`;
        html += `  </div>\n`;
        html += `  <div class="navigation">\n`;

        html += getTrashCanHTML(trip.name);

        html += `    \n`;
        html += `  </div>\n`;
        html += `</div>\n`;
      }
      
      tripsElement.innerHTML = html;
    }

    function getTrashCanHTML(tripName) {
      let html = '';
      
      html += `    <span onclick="deleteTrip('${tripName}')">\n`;
      html += `    <svg version="1.1" id="Capa_1" xmlns="http://www.w3.org/2000/svg"\n`;
      html += `      xmlns:xlink="http://www.w3.org/1999/xlink"\n`;
      html += `      x="0px" y="0px" width="774.266px" height="774.266px" viewBox="0 0 774.266 774.266"\n`;
	    html += `      xml:space="preserve">\n`;
      html += `      <g>\n`;
	    html += `        <path d="M640.35,91.169H536.971V23.991C536.971,10.469,526.064,0,512.543,0c-1.312,0-2.187,0.438-2.614,0.875\n`;
		  html += `          C509.491,0.438,508.616,0,508.179,0H265.212h-1.74h-1.75c-13.521,0-23.99,10.469-23.99,23.991v67.179H133.916\n`;
		  html += `          c-29.667,0-52.783,23.116-52.783,52.783v38.387v47.981h45.803v491.6c0,29.668,22.679,52.346,52.346,52.346h415.703\n`;
		  html += `          c29.667,0,52.782-22.678,52.782-52.346v-491.6h45.366v-47.981v-38.387C693.133,114.286,670.008,91.169,640.35,91.169z\n`;
			html += `          M285.713,47.981h202.84v43.188h-202.84V47.981z M599.349,721.922c0,3.061-1.312,4.363-4.364,4.363H179.282\n`;
		  html += `          c-3.052,0-4.364-1.303-4.364-4.363V230.32h424.431V721.922z M644.715,182.339H129.551v-38.387c0-3.053,1.312-4.802,4.364-4.802\n`;
		  html += `          H640.35c3.053,0,4.365,1.749,4.365,4.802V182.339z"/>\n`;
	    html += `          <rect x="475.031" y="286.593" width="48.418" height="396.942"/>\n`;
	    html += `          <rect x="363.361" y="286.593" width="48.418" height="396.942"/>\n`;
	    html += `          <rect x="251.69" y="286.593" width="48.418" height="396.942"/>\n`;
      html += `      </g>\n`;
      html += `    </svg>\n`;
      html += `    </span>\n`;

      return html;
    }

    function startTrip(tripName) {
      storage.setActiveTrip(tripName);
      window.location.href = 'game.html';
    }

    function deleteTrip(tripName) {
      storage.deleteTrip(tripName);
      buildTrips();
    }

  </script>

  <script>
    if ('serviceWorker' in navigator) {
      window.addEventListener('load', () => {
        navigator.serviceWorker
          .register('service-worker.js')
          .then(() => {
            console.log('Registering Service Worker')
          })
          .catch(err => {
            console.log(`Error: ${err}`);
          });
      });
    }
  </script>

  <!-- The core Firebase JS SDK is always required and must be listed first -->
  <script src="/__/firebase/6.0.2/firebase-app.js"></script>

  <!-- TODO: Add SDKs for Firebase products that you want to use
      https://firebase.google.com/docs/web/setup#reserved-urls -->

  <!-- Initialize Firebase -->
  <script src="/__/firebase/init.js"></script>
</body>
</html>